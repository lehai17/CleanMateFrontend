{"ast":null,"code":"import _objectSpread from\"E:/cleanmate/cleanMateWeb/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useMemo,useState}from\"react\";import{Link}from\"react-router-dom\";import{createBooking}from\"../api/bookings\";import Header from\"../components/Header\";/* =========================\r\n   Data & Helpers\r\n========================= */import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL;const SERVICES={cleaning:{name:\"Dọn Dẹp Tổng Quát\",price:70000,icon:\"🧽\",minHours:1},cooking:{name:\"Nấu Ăn & Rửa Bát\",price:90000,icon:\"👩‍🍳\",minHours:1},laundry:{name:\"Giặt Ủi Quần Áo\",price:70000,icon:\"👕\",minHours:1},childcare:{name:\"Chăm Sóc Trẻ Em\",price:100000,icon:\"👶\",minHours:1}};const toDateStr=d=>{const y=d.getFullYear();const m=String(d.getMonth()+1).padStart(2,\"0\");const day=String(d.getDate()).padStart(2,\"0\");return\"\".concat(y,\"-\").concat(m,\"-\").concat(day);};const TODAY_STR=toDateStr(new Date());function ProgressSteps(_ref){let{currentStep=1}=_ref;const steps=[{id:1,name:\"Chọn dịch vụ\"},{id:2,name:\"Chọn thời gian\"},{id:3,name:\"Thông tin\"},{id:4,name:\"Xác nhận\"}];const dotClass=id=>{if(id<currentStep)return\"bg-emerald-500 text-white\";if(id===currentStep)return\"bg-gradient-to-br from-emerald-600 to-amber-500 text-white shadow\";return\"bg-slate-200 text-slate-500\";};const textClass=id=>id<=currentStep?\"text-emerald-700\":\"text-slate-500\";return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-b\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:steps.map((step,idx)=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold \".concat(dotClass(step.id)),children:step.id}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:block text-sm font-medium \".concat(textClass(step.id)),children:step.name})]}),idx<steps.length-1&&/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 h-px bg-slate-200 mx-4\"})]},step.id))})})});}/* =========================\r\n   Step 1: Chọn dịch vụ\r\n========================= */function ServiceCard(_ref2){let{k,data,selected,onSelect}=_ref2;return/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>onSelect(k),className:\"text-left rounded-2xl border-2 transition-all p-5 bg-white shadow-sm hover:shadow-md\\n                  focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\\n        \".concat(selected?\"border-transparent ring-2 ring-offset-2 ring-emerald-600 bg-gradient-to-br from-emerald-50 to-amber-50\":\"border-transparent hover:border-emerald-200\",\"\\n      \"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-14 h-14 rounded-xl flex items-center justify-center text-2xl bg-emerald-50\",children:data.icon}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg sm:text-xl font-semibold text-gray-900 mb-1\",children:data.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-3\",children:[k===\"cleaning\"&&\"Vệ sinh toàn bộ nhà cửa, lau chùi, hút bụi, sắp xếp đồ đạc\",k===\"cooking\"&&\"Chuẩn bị bữa ăn theo yêu cầu, rửa bát đĩa, dọn dẹp bếp\",k===\"laundry\"&&\"Giặt giũ, phơi khô, ủi là và sắp xếp quần áo gọn gàng\",k===\"childcare\"&&\"Trông trẻ, cho ăn, vui chơi và các hoạt động phù hợp\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-2xl font-bold bg-gradient-to-r from-emerald-600 to-amber-500 bg-clip-text text-transparent\",children:[data.price.toLocaleString(\"vi-VN\"),\"\\u0111/gi\\u1EDD\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs sm:text-sm inline-flex items-center gap-1 px-2 py-1 rounded-full\\r bg-emerald-50 text-emerald-700 border border-emerald-200\",children:[\"T\\u1ED1i thi\\u1EC3u \",data.minHours,\" gi\\u1EDD\"]})]})]})]})});}function StepService(_ref3){let{selected,setSelected,onNext}=_ref3;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 mb-3\",children:\"Ch\\u1ECDn d\\u1ECBch v\\u1EE5\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"L\\u1EF1a ch\\u1ECDn d\\u1ECBch v\\u1EE5 ph\\xF9 h\\u1EE3p v\\u1EDBi nhu c\\u1EA7u c\\u1EE7a b\\u1EA1n\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid md:grid-cols-2 gap-6\",children:Object.entries(SERVICES).map(_ref4=>{let[k,v]=_ref4;return/*#__PURE__*/_jsx(ServiceCard,{k:k,data:v,selected:selected===k,onSelect:setSelected},k);})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:onNext,disabled:!selected,className:\"inline-flex items-center justify-center rounded-xl px-8 py-3 font-semibold text-white shadow transition\\r disabled:cursor-not-allowed disabled:opacity-50\\r bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\\r focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\",children:\"Ti\\u1EBFp t\\u1EE5c\"})})]});}/* =========================\r\n   Step 2: Chọn thời gian\r\n========================= */function Calendar(_ref5){let{selectedDate,onDateSelect}=_ref5;const today=new Date();const[currentMonth,setCurrentMonth]=useState(today.getMonth());const[currentYear,setCurrentYear]=useState(today.getFullYear());const monthNames=[\"Tháng 1\",\"Tháng 2\",\"Tháng 3\",\"Tháng 4\",\"Tháng 5\",\"Tháng 6\",\"Tháng 7\",\"Tháng 8\",\"Tháng 9\",\"Tháng 10\",\"Tháng 11\",\"Tháng 12\"];const days=useMemo(()=>{const firstDay=new Date(currentYear,currentMonth,1).getDay();// 0=CN\nconst daysInMonth=new Date(currentYear,currentMonth+1,0).getDate();const arr=[];for(let i=0;i<firstDay;i++)arr.push(null);for(let d=1;d<=daysInMonth;d++){const dateObj=new Date(currentYear,currentMonth,d);const dateStr=toDateStr(dateObj);const isToday=dateStr===TODAY_STR;const isPast=dateObj<new Date(today.getFullYear(),today.getMonth(),today.getDate());const isSelected=selectedDate===dateStr;arr.push({d,dateStr,isToday,isPast,isSelected});}const rem=arr.length%7;if(rem)for(let i=0;i<7-rem;i++)arr.push(null);return arr;},[currentMonth,currentYear,selectedDate]);const previousMonth=()=>{if(currentMonth===0){setCurrentMonth(11);setCurrentYear(y=>y-1);}else setCurrentMonth(m=>m-1);};const nextMonth=()=>{if(currentMonth===11){setCurrentMonth(0);setCurrentYear(y=>y+1);}else setCurrentMonth(m=>m+1);};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Ch\\u1ECDn ng\\xE0y\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:previousMonth,className:\"p-2 hover:bg-gray-100 rounded-lg\",\"aria-label\":\"Th\\xE1ng tr\\u01B0\\u1EDBc\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M15 19l-7-7 7-7\"})})}),/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg font-semibold\",children:[monthNames[currentMonth],\", \",currentYear]}),/*#__PURE__*/_jsx(\"button\",{onClick:nextMonth,className:\"p-2 hover:bg-gray-100 rounded-lg\",\"aria-label\":\"Th\\xE1ng sau\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M9 5l7 7-7 7\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-7 gap-1 mb-2\",children:[\"CN\",\"T2\",\"T3\",\"T4\",\"T5\",\"T6\",\"T7\"].map(w=>/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-sm font-medium text-gray-500 py-2\",children:w},w))}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-7 gap-1\",children:days.map((cell,idx)=>{if(!cell)return/*#__PURE__*/_jsx(\"div\",{},\"e-\".concat(idx));const{d,dateStr,isToday,isPast,isSelected}=cell;const base=\"p-3 text-center rounded-lg transition-all select-none\";const state=isPast?\"text-gray-400 cursor-not-allowed\":isSelected?\"bg-gradient-to-br from-emerald-600 to-amber-500 text-white shadow cursor-pointer\":isToday?\"ring-2 ring-amber-400 text-emerald-700 cursor-pointer\":\"hover:bg-gray-100 cursor-pointer\";return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(base,\" \").concat(state),onClick:!isPast?()=>onDateSelect(dateStr):undefined,title:dateStr,children:d},dateStr);})})]});}function TimeAndDuration(_ref6){var _service$minHours;let{service,duration,setDuration,selectedDate,selectedTime,setSelectedTime,totalPrice}=_ref6;const minHours=(_service$minHours=service===null||service===void 0?void 0:service.minHours)!==null&&_service$minHours!==void 0?_service$minHours:2;const minTime=useMemo(()=>{if(!selectedDate)return\"00:00\";if(selectedDate!==TODAY_STR)return\"00:00\";const now=new Date();const hh=String(now.getHours()).padStart(2,\"0\");const mm=String(now.getMinutes()).padStart(2,\"0\");return\"\".concat(hh,\":\").concat(mm);},[selectedDate]);const adjust=delta=>{const v=Number((duration+delta).toFixed(1));if(v>=minHours&&v<=8)setDuration(v);};const isTimeValid=useMemo(()=>{if(!selectedDate||!selectedTime)return false;if(selectedDate!==TODAY_STR)return true;const[hh,mm]=selectedTime.split(\":\").map(Number);const chosen=new Date(\"\".concat(selectedDate,\"T\").concat(String(hh).padStart(2,\"0\"),\":\").concat(String(mm).padStart(2,\"0\"),\":00\"));return chosen.getTime()>=Date.now();},[selectedDate,selectedTime]);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Ch\\u1ECDn gi\\u1EDD & th\\u1EDDi l\\u01B0\\u1EE3ng\"}),/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Gi\\u1EDD b\\u1EAFt \\u0111\\u1EA7u\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",step:60,min:minTime,max:\"23:59\",value:selectedTime||\"\",onChange:e=>setSelectedTime(e.target.value),className:\"w-full rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-600\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-xs text-gray-500\",children:\"B\\u1EA1n c\\xF3 th\\u1EC3 ch\\u1ECDn b\\u1EA5t k\\u1EF3 th\\u1EDDi \\u0111i\\u1EC3m n\\xE0o trong ng\\xE0y (\\u0111\\u1ED9 ph\\xE2n gi\\u1EA3i 1 ph\\xFAt).\"}),!isTimeValid&&selectedTime&&selectedDate===TODAY_STR&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded-lg p-3\",children:\"Gi\\u1EDD b\\u1EA1n ch\\u1ECDn \\u0111\\xE3 qua so v\\u1EDBi th\\u1EDDi \\u0111i\\u1EC3m hi\\u1EC7n t\\u1EA1i. Vui l\\xF2ng ch\\u1ECDn gi\\u1EDD l\\u1EDBn h\\u01A1n.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-3\",children:\"Th\\u1EDDi gian l\\xE0m vi\\u1EC7c\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>adjust(-0.5),className:\"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200\",children:\"-\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold bg-gradient-to-r from-emerald-600 to-amber-500 bg-clip-text text-transparent\",children:duration.toFixed(1)}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[\"gi\\u1EDD (t\\u1ED1i thi\\u1EC3u \",minHours,\" gi\\u1EDD)\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>adjust(0.5),className:\"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200\",children:\"+\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-semibold text-gray-900\",children:[\"T\\u1ED5ng ti\\u1EC1n:\",\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-600\",children:[totalPrice.toLocaleString(\"vi-VN\"),\"\\u0111\"]})]})})]})]});}function StepTime(_ref7){let{service,selectedDate,setSelectedDate,selectedTime,setSelectedTime,duration,setDuration,onNext,onBack,totalPrice}=_ref7;const canNext=selectedDate&&selectedTime&&(selectedDate!==TODAY_STR||(()=>{const[hh,mm]=selectedTime.split(\":\").map(Number);const chosen=new Date(\"\".concat(selectedDate,\"T\").concat(String(hh).padStart(2,\"0\"),\":\").concat(String(mm).padStart(2,\"0\"),\":00\"));return chosen.getTime()>=Date.now();})());return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 mb-3\",children:\"Ch\\u1ECDn th\\u1EDDi gian\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"L\\u1EF1a ch\\u1ECDn ng\\xE0y & gi\\u1EDD ph\\xF9 h\\u1EE3p v\\u1EDBi l\\u1ECBch tr\\xECnh c\\u1EE7a b\\u1EA1n\"}),service&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-sm text-gray-600\",children:[\"D\\u1ECBch v\\u1EE5: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:service.name}),\" \\u2022 Gi\\xE1: \",service.price.toLocaleString(\"vi-VN\"),\"\\u0111/gi\\u1EDD \\u2022 T\\u1ED1i thi\\u1EC3u\",\" \",service.minHours,\"h\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid lg:grid-cols-2 gap-8\",children:[/*#__PURE__*/_jsx(Calendar,{selectedDate:selectedDate,onDateSelect:setSelectedDate}),/*#__PURE__*/_jsx(TimeAndDuration,{service:service,duration:duration,setDuration:setDuration,selectedDate:selectedDate,selectedTime:selectedTime,setSelectedTime:setSelectedTime,totalPrice:totalPrice})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 flex justify-between\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onBack,className:\"px-8 py-3 rounded-lg font-semibold bg-gray-200 text-gray-700 hover:bg-gray-300 transition\",children:\"Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onNext,disabled:!canNext,className:\"px-8 py-3 rounded-lg font-semibold text-white shadow disabled:cursor-not-allowed disabled:opacity-50\\r bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\\r focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\",children:\"Ti\\u1EBFp t\\u1EE5c\"})]})]});}/* =========================\r\n   Step 3: Thông tin khách hàng\r\n========================= */function StepCustomer(_ref8){let{customerInfo,setCustomerInfo,onNext,onBack,pricing}=_ref8;const handleInputChange=(field,value)=>{setCustomerInfo(_objectSpread(_objectSpread({},customerInfo),{},{[field]:value}));};const validateAndNext=()=>{const{name,phone,address}=customerInfo;if(!name.trim()||!phone.trim()||!address.trim()){alert(\"Vui lòng điền đầy đủ thông tin bắt buộc (Họ tên, Số điện thoại, Địa chỉ)\");return;}onNext();};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-900 mb-2\",children:\"Th\\xF4ng tin kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Vui l\\xF2ng cung c\\u1EA5p th\\xF4ng tin \\u0111\\u1EC3 ch\\xFAng t\\xF4i li\\xEAn l\\u1EA1c v\\xE0 cung c\\u1EA5p d\\u1ECBch v\\u1EE5\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-2 bg-white rounded-xl shadow-sm p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"H\\u1ECD v\\xE0 t\\xEAn *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:customerInfo.name,onChange:e=>handleInputChange(\"name\",e.target.value),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\",placeholder:\"Nh\\u1EADp h\\u1ECD v\\xE0 t\\xEAn\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:customerInfo.phone,onChange:e=>handleInputChange(\"phone\",e.target.value),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\",placeholder:\"Nh\\u1EADp s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:customerInfo.email,onChange:e=>handleInputChange(\"email\",e.target.value),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\",placeholder:\"Nh\\u1EADp \\u0111\\u1ECBa ch\\u1EC9 email\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"\\u0110\\u1ECBa ch\\u1EC9 *\"}),/*#__PURE__*/_jsx(\"textarea\",{rows:3,value:customerInfo.address,onChange:e=>handleInputChange(\"address\",e.target.value),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\",placeholder:\"Nh\\u1EADp \\u0111\\u1ECBa ch\\u1EC9 chi ti\\u1EBFt (s\\u1ED1 nh\\xE0, \\u0111\\u01B0\\u1EDDng, ph\\u01B0\\u1EDDng/x\\xE3, qu\\u1EADn/huy\\u1EC7n)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Ghi ch\\xFA \\u0111\\u1EB7c bi\\u1EC7t\"}),/*#__PURE__*/_jsx(\"textarea\",{rows:3,value:customerInfo.notes,onChange:e=>handleInputChange(\"notes\",e.target.value),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\",placeholder:\"Y\\xEAu c\\u1EA7u \\u0111\\u1EB7c bi\\u1EC7t, h\\u01B0\\u1EDBng d\\u1EABn \\u0111\\u1EBFn \\u0111\\u1ECBa ch\\u1EC9, l\\u01B0u \\xFD v\\u1EC1 th\\xFA c\\u01B0ng...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-emerald-50 border border-emerald-200 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-emerald-900 mb-2\",children:\"Ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"payment\",value:\"cash\",checked:customerInfo.paymentMethod===\"cash\",onChange:e=>handleInputChange(\"paymentMethod\",e.target.value),className:\"accent-emerald-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-emerald-800\",children:\"\\uD83D\\uDCB0 Thanh to\\xE1n ti\\u1EC1n m\\u1EB7t\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"payment\",value:\"online\",checked:customerInfo.paymentMethod===\"online\",onChange:e=>handleInputChange(\"paymentMethod\",e.target.value),className:\"accent-emerald-600\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-emerald-800\",children:[\"\\uD83D\\uDCB3 Thanh to\\xE1n online\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"(Gi\\u1EA3m 5%)\"})]})]})]})]})]})}),/*#__PURE__*/_jsxs(\"aside\",{className:\"bg-white rounded-xl shadow-sm p-6 h-max\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"T\\xF3m t\\u1EAFt \\u0111\\u01A1n h\\xE0ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 text-sm\",children:[/*#__PURE__*/_jsx(Row,{label:\"D\\u1ECBch v\\u1EE5\",value:pricing.serviceName}),/*#__PURE__*/_jsx(Row,{label:\"Ng\\xE0y\",value:pricing.date}),/*#__PURE__*/_jsx(Row,{label:\"Gi\\u1EDD b\\u1EAFt \\u0111\\u1EA7u\",value:pricing.time}),/*#__PURE__*/_jsx(Row,{label:\"Th\\u1EDDi l\\u01B0\\u1EE3ng\",value:\"\".concat(pricing.duration,\" gi\\u1EDD\")}),/*#__PURE__*/_jsx(Row,{label:\"T\\u1EA1m t\\xEDnh\",value:\"\".concat(pricing.subtotal.toLocaleString(\"vi-VN\"),\"\\u0111\")}),pricing.discount>0&&/*#__PURE__*/_jsx(Row,{label:\"Gi\\u1EA3m gi\\xE1 (5% online)\",value:\"- \".concat(pricing.discount.toLocaleString(\"vi-VN\"),\"\\u0111\"),className:\"text-emerald-700\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-3 mt-3 border-t border-gray-200 flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-900\",children:\"T\\u1ED5ng c\\u1ED9ng\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-bold text-emerald-600\",children:[pricing.total.toLocaleString(\"vi-VN\"),\"\\u0111\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 flex justify-between\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onBack,className:\"bg-gray-200 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors\",children:\"Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"button\",{onClick:validateAndNext,className:\"px-8 py-3 rounded-lg font-semibold text-white shadow\\r bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\\r focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\",children:\"Ti\\u1EBFp t\\u1EE5c\"})]})]});}function Row(_ref9){let{label,value,className=\"\"}=_ref9;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between \".concat(className),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:label}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-900 font-medium\",children:value})]});}/* =========================\r\n   Step 4: Xác nhận\r\n========================= */function formatDateVN(dateString){if(!dateString)return\"\";const d=new Date(dateString);return d.toLocaleDateString(\"vi-VN\",{weekday:\"long\",year:\"numeric\",month:\"long\",day:\"numeric\"});}function StepConfirm(_ref0){var _customer$notes;let{service,date,time,duration,customer,pricing,onBack,onConfirm}=_ref0;if(!service||!customer)return null;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 mb-3\",children:\"X\\xE1c nh\\u1EADn \\u0111\\u1EB7t l\\u1ECBch\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Vui l\\xF2ng ki\\u1EC3m tra l\\u1EA1i th\\xF4ng tin tr\\u01B0\\u1EDBc khi x\\xE1c nh\\u1EADn\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"border-b pb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Th\\xF4ng tin d\\u1ECBch v\\u1EE5\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center text-xl\",children:service.icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900\",children:service.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-emerald-600\",children:[service.price.toLocaleString(\"vi-VN\"),\"\\u0111/gi\\u1EDD\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Ng\\xE0y:\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:formatDateVN(date)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Gi\\u1EDD: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:time})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Th\\u1EDDi l\\u01B0\\u1EE3ng:\",\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-gray-900\",children:[duration,\" gi\\u1EDD\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"border-b pb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Th\\xF4ng tin kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"H\\u1ECD t\\xEAn:\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:customer.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u0110i\\u1EC7n tho\\u1EA1i:\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:customer.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Email:\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:customer.email||\"Không có\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u0110\\u1ECBa ch\\u1EC9:\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:customer.address})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Thanh to\\xE1n:\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:customer.paymentMethod===\"cash\"?\"Tiền mặt\":\"Thanh toán online (giảm 5%)\"})]}),((_customer$notes=customer.notes)===null||_customer$notes===void 0?void 0:_customer$notes.trim())&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Ghi ch\\xFA:\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:customer.notes})]})]})]})]}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Chi ti\\u1EBFt thanh to\\xE1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"T\\u1EA1m t\\xEDnh:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[pricing.subtotal.toLocaleString(\"vi-VN\"),\"\\u0111\"]})]}),pricing.discount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-emerald-700\",children:\"Gi\\u1EA3m gi\\xE1 (5% online):\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-emerald-700\",children:[\"-\",pricing.discount.toLocaleString(\"vi-VN\"),\"\\u0111\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-2 mt-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-semibold text-gray-900\",children:\"T\\u1ED5ng c\\u1ED9ng:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-2xl font-bold text-emerald-600\",children:[pricing.total.toLocaleString(\"vi-VN\"),\"\\u0111\"]})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 flex justify-between\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onBack,className:\"bg-gray-200 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors\",children:\"Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onConfirm,className:\"px-8 py-3 rounded-lg font-semibold text-white shadow\\r bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\\r focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\",children:\"X\\xE1c nh\\u1EADn \\u0111\\u1EB7t l\\u1ECBch\"})]})]})})]});}/* =========================\r\n   Success (hiện sau khi xác nhận, không tính bước)\r\n========================= */function Success(_ref1){let{code,onNew,onHome}=_ref1;return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm p-10 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-6\",children:\"\\u2705\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-3\",children:\"\\u0110\\u1EB7t l\\u1ECBch th\\xE0nh c\\xF4ng!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-8\",children:\"C\\u1EA3m \\u01A1n b\\u1EA1n \\u0111\\xE3 tin t\\u01B0\\u1EDFng CleanMate. Ch\\xFAng t\\xF4i s\\u1EBD li\\xEAn h\\u1EC7 trong th\\u1EDDi gian s\\u1EDBm nh\\u1EA5t \\u0111\\u1EC3 x\\xE1c nh\\u1EADn chi ti\\u1EBFt.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-emerald-50 border border-emerald-200 p-6 rounded-lg mb-8\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-emerald-900 mb-2\",children:\"M\\xE3 \\u0111\\u1EB7t l\\u1ECBch c\\u1EE7a b\\u1EA1n:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-emerald-700\",children:code})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onNew,className:\"w-full px-8 py-3 rounded-lg font-semibold text-white shadow\\r bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\\r focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\",children:\"\\u0110\\u1EB7t l\\u1ECBch m\\u1EDBi\"}),/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"block w-full bg-gray-200 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors text-center\",children:\"V\\u1EC1 trang ch\\u1EE7\"})]})]})});}/* =========================\r\n   MAIN: Booking (4 bước)\r\n========================= */export default function Booking(){var _service$minHours2;const[currentStep,setCurrentStep]=useState(1);const[selectedKey,setSelectedKey]=useState(null);const service=selectedKey?SERVICES[selectedKey]:null;const[selectedDate,setSelectedDate]=useState(TODAY_STR);const[selectedTime,setSelectedTime]=useState(\"\");const[duration,setDuration]=useState((_service$minHours2=service===null||service===void 0?void 0:service.minHours)!==null&&_service$minHours2!==void 0?_service$minHours2:2);const[customerInfo,setCustomerInfo]=useState({name:\"\",phone:\"\",email:\"\",address:\"\",notes:\"\",paymentMethod:\"cash\"});const subtotal=useMemo(()=>service?service.price*duration:0,[service,duration]);const discount=useMemo(()=>customerInfo.paymentMethod===\"online\"?Math.round(subtotal*0.05):0,[customerInfo.paymentMethod,subtotal]);const total=useMemo(()=>Math.max(0,subtotal-discount),[subtotal,discount]);const[successCode,setSuccessCode]=useState(\"\");const goNext=()=>setCurrentStep(s=>Math.min(4,s+1));const goBack=()=>setCurrentStep(s=>Math.max(1,s-1));const onServiceNext=()=>{if(!selectedKey)return;// bảo đảm duration tối thiểu theo service\nsetDuration(SERVICES[selectedKey].minHours);goNext();window.scrollTo({top:0,behavior:\"smooth\"});};const onTimeNext=()=>{// validate ở StepTime đã disable nút; vẫn phòng hờ:\nif(!selectedDate||!selectedTime)return;goNext();window.scrollTo({top:0,behavior:\"smooth\"});};const onCustomerNext=()=>{const{name,phone,address}=customerInfo;if(!name.trim()||!phone.trim()||!address.trim())return;goNext();window.scrollTo({top:0,behavior:\"smooth\"});};const onConfirm=async()=>{// debug: kiểm tra token hiện có\nconsole.log(\"Token when booking:\",localStorage.getItem(\"cm_token\"));try{const res=await createBooking({CleanerId:1,// gửi ISO thật sự để .NET parse an toàn\nStartTime:new Date(\"\".concat(selectedDate,\"T\").concat(selectedTime,\":00\")).toISOString(),DurationHours:duration,Price:total,Address:customerInfo.address,Notes:customerInfo.notes,PaymentMethod:customerInfo.paymentMethod});setSuccessCode(\"CM\"+String(res.id).padStart(6,\"0\"));setCurrentStep(99);}catch(err){var _err$response,_err$response2,_err$response3;console.error(\"createBooking error:\",{status:err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status,data:err===null||err===void 0?void 0:(_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data});alert((err===null||err===void 0?void 0:(_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.data)||\"Đặt lịch thất bại\");}};const resetAll=()=>{setCurrentStep(1);setSelectedKey(null);setSelectedDate(TODAY_STR);setSelectedTime(\"\");setDuration(2);setCustomerInfo({name:\"\",phone:\"\",email:\"\",address:\"\",notes:\"\",paymentMethod:\"cash\"});setSuccessCode(\"\");window.scrollTo({top:0,behavior:\"smooth\"});};const pricingSummary={serviceName:(service===null||service===void 0?void 0:service.name)||\"\",date:selectedDate,time:selectedTime,duration,subtotal,discount,total};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50 text-gray-800\",children:[currentStep>=1&&currentStep<=4&&/*#__PURE__*/_jsx(ProgressSteps,{currentStep:currentStep}),/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10\",children:[currentStep===1&&/*#__PURE__*/_jsx(StepService,{selected:selectedKey,setSelected:setSelectedKey,onNext:onServiceNext}),currentStep===2&&/*#__PURE__*/_jsx(StepTime,{service:service,selectedDate:selectedDate,setSelectedDate:setSelectedDate,selectedTime:selectedTime,setSelectedTime:setSelectedTime,duration:duration,setDuration:setDuration,totalPrice:subtotal,onNext:onTimeNext,onBack:goBack}),currentStep===3&&/*#__PURE__*/_jsx(StepCustomer,{customerInfo:customerInfo,setCustomerInfo:setCustomerInfo,pricing:pricingSummary,onNext:onCustomerNext,onBack:goBack}),currentStep===4&&/*#__PURE__*/_jsx(StepConfirm,{service:service,date:selectedDate,time:selectedTime,duration:duration,customer:customerInfo,pricing:pricingSummary,onBack:goBack,onConfirm:onConfirm}),currentStep===99&&/*#__PURE__*/_jsx(Success,{code:successCode,onNew:resetAll,onHome:()=>{/* Link trong component */}})]})]});}","map":{"version":3,"names":["React","useMemo","useState","Link","createBooking","Header","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_URL","process","env","REACT_APP_API_URL","SERVICES","cleaning","name","price","icon","minHours","cooking","laundry","childcare","toDateStr","d","y","getFullYear","m","String","getMonth","padStart","day","getDate","concat","TODAY_STR","Date","ProgressSteps","_ref","currentStep","steps","id","dotClass","textClass","className","children","map","step","idx","length","ServiceCard","_ref2","k","data","selected","onSelect","type","onClick","toLocaleString","StepService","_ref3","setSelected","onNext","Object","entries","_ref4","v","disabled","Calendar","_ref5","selectedDate","onDateSelect","today","currentMonth","setCurrentMonth","currentYear","setCurrentYear","monthNames","days","firstDay","getDay","daysInMonth","arr","i","push","dateObj","dateStr","isToday","isPast","isSelected","rem","previousMonth","nextMonth","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","w","cell","base","state","undefined","title","TimeAndDuration","_ref6","_service$minHours","service","duration","setDuration","selectedTime","setSelectedTime","totalPrice","minTime","now","hh","getHours","mm","getMinutes","adjust","delta","Number","toFixed","isTimeValid","split","chosen","getTime","min","max","value","onChange","e","target","StepTime","_ref7","setSelectedDate","onBack","canNext","StepCustomer","_ref8","customerInfo","setCustomerInfo","pricing","handleInputChange","field","_objectSpread","validateAndNext","phone","address","trim","alert","placeholder","email","rows","notes","checked","paymentMethod","Row","label","serviceName","date","time","subtotal","discount","total","_ref9","formatDateVN","dateString","toLocaleDateString","weekday","year","month","StepConfirm","_ref0","_customer$notes","customer","onConfirm","Success","_ref1","code","onNew","onHome","to","Booking","_service$minHours2","setCurrentStep","selectedKey","setSelectedKey","Math","round","successCode","setSuccessCode","goNext","s","goBack","onServiceNext","window","scrollTo","top","behavior","onTimeNext","onCustomerNext","console","log","localStorage","getItem","res","CleanerId","StartTime","toISOString","DurationHours","Price","Address","Notes","PaymentMethod","err","_err$response","_err$response2","_err$response3","error","status","response","resetAll","pricingSummary"],"sources":["E:/cleanmate/cleanMateWeb/src/pages/Booking.jsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { createBooking } from \"../api/bookings\";\r\nimport Header from \"../components/Header\";\r\n\r\n/* =========================\r\n   Data & Helpers\r\n========================= */\r\nconst API_URL = process.env.REACT_APP_API_URL;\r\n\r\nconst SERVICES = {\r\n  cleaning: {\r\n    name: \"Dọn Dẹp Tổng Quát\",\r\n    price: 70000,\r\n    icon: \"🧽\",\r\n    minHours: 1,\r\n  },\r\n  cooking: {\r\n    name: \"Nấu Ăn & Rửa Bát\",\r\n    price: 90000,\r\n    icon: \"👩‍🍳\",\r\n    minHours: 1,\r\n  },\r\n  laundry: { name: \"Giặt Ủi Quần Áo\", price: 70000, icon: \"👕\", minHours: 1 },\r\n  childcare: {\r\n    name: \"Chăm Sóc Trẻ Em\",\r\n    price: 100000,\r\n    icon: \"👶\",\r\n    minHours: 1,\r\n  },\r\n};\r\n\r\nconst toDateStr = (d) => {\r\n  const y = d.getFullYear();\r\n  const m = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const day = String(d.getDate()).padStart(2, \"0\");\r\n  return `${y}-${m}-${day}`;\r\n};\r\nconst TODAY_STR = toDateStr(new Date());\r\n\r\nfunction ProgressSteps({ currentStep = 1 }) {\r\n  const steps = [\r\n    { id: 1, name: \"Chọn dịch vụ\" },\r\n    { id: 2, name: \"Chọn thời gian\" },\r\n    { id: 3, name: \"Thông tin\" },\r\n    { id: 4, name: \"Xác nhận\" },\r\n  ];\r\n  const dotClass = (id) => {\r\n    if (id < currentStep) return \"bg-emerald-500 text-white\";\r\n    if (id === currentStep)\r\n      return \"bg-gradient-to-br from-emerald-600 to-amber-500 text-white shadow\";\r\n    return \"bg-slate-200 text-slate-500\";\r\n  };\r\n  const textClass = (id) =>\r\n    id <= currentStep ? \"text-emerald-700\" : \"text-slate-500\";\r\n\r\n  return (\r\n    <div className=\"bg-white border-b\">\r\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          {steps.map((step, idx) => (\r\n            <React.Fragment key={step.id}>\r\n              <div className=\"flex items-center gap-3\">\r\n                <div\r\n                  className={`w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold ${dotClass(\r\n                    step.id\r\n                  )}`}\r\n                >\r\n                  {step.id}\r\n                </div>\r\n                <span\r\n                  className={`hidden sm:block text-sm font-medium ${textClass(\r\n                    step.id\r\n                  )}`}\r\n                >\r\n                  {step.name}\r\n                </span>\r\n              </div>\r\n              {idx < steps.length - 1 && (\r\n                <div className=\"flex-1 h-px bg-slate-200 mx-4\" />\r\n              )}\r\n            </React.Fragment>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* =========================\r\n   Step 1: Chọn dịch vụ\r\n========================= */\r\nfunction ServiceCard({ k, data, selected, onSelect }) {\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={() => onSelect(k)}\r\n      className={`text-left rounded-2xl border-2 transition-all p-5 bg-white shadow-sm hover:shadow-md\r\n                  focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\r\n        ${\r\n          selected\r\n            ? \"border-transparent ring-2 ring-offset-2 ring-emerald-600 bg-gradient-to-br from-emerald-50 to-amber-50\"\r\n            : \"border-transparent hover:border-emerald-200\"\r\n        }\r\n      `}\r\n    >\r\n      <div className=\"flex items-start gap-4\">\r\n        <div className=\"w-14 h-14 rounded-xl flex items-center justify-center text-2xl bg-emerald-50\">\r\n          {data.icon}\r\n        </div>\r\n        <div className=\"flex-1\">\r\n          <h3 className=\"text-lg sm:text-xl font-semibold text-gray-900 mb-1\">\r\n            {data.name}\r\n          </h3>\r\n          <p className=\"text-sm text-gray-600 mb-3\">\r\n            {k === \"cleaning\" &&\r\n              \"Vệ sinh toàn bộ nhà cửa, lau chùi, hút bụi, sắp xếp đồ đạc\"}\r\n            {k === \"cooking\" &&\r\n              \"Chuẩn bị bữa ăn theo yêu cầu, rửa bát đĩa, dọn dẹp bếp\"}\r\n            {k === \"laundry\" &&\r\n              \"Giặt giũ, phơi khô, ủi là và sắp xếp quần áo gọn gàng\"}\r\n            {k === \"childcare\" &&\r\n              \"Trông trẻ, cho ăn, vui chơi và các hoạt động phù hợp\"}\r\n          </p>\r\n          <div className=\"flex items-center justify-between\">\r\n            <span className=\"text-2xl font-bold bg-gradient-to-r from-emerald-600 to-amber-500 bg-clip-text text-transparent\">\r\n              {data.price.toLocaleString(\"vi-VN\")}đ/giờ\r\n            </span>\r\n            <span\r\n              className=\"text-xs sm:text-sm inline-flex items-center gap-1 px-2 py-1 rounded-full\r\n                             bg-emerald-50 text-emerald-700 border border-emerald-200\"\r\n            >\r\n              Tối thiểu {data.minHours} giờ\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </button>\r\n  );\r\n}\r\n\r\nfunction StepService({ selected, setSelected, onNext }) {\r\n  return (\r\n    <>\r\n      <div className=\"text-center mb-8\">\r\n        <h1 className=\"text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 mb-3\">\r\n          Chọn dịch vụ\r\n        </h1>\r\n        <p className=\"text-gray-600\">\r\n          Lựa chọn dịch vụ phù hợp với nhu cầu của bạn\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"grid md:grid-cols-2 gap-6\">\r\n        {Object.entries(SERVICES).map(([k, v]) => (\r\n          <ServiceCard\r\n            key={k}\r\n            k={k}\r\n            data={v}\r\n            selected={selected === k}\r\n            onSelect={setSelected}\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"mt-8 flex items-center justify-center\">\r\n        <button\r\n          onClick={onNext}\r\n          disabled={!selected}\r\n          className=\"inline-flex items-center justify-center rounded-xl px-8 py-3 font-semibold text-white shadow transition\r\n                     disabled:cursor-not-allowed disabled:opacity-50\r\n                     bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\r\n                     focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\"\r\n        >\r\n          Tiếp tục\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n/* =========================\r\n   Step 2: Chọn thời gian\r\n========================= */\r\nfunction Calendar({ selectedDate, onDateSelect }) {\r\n  const today = new Date();\r\n  const [currentMonth, setCurrentMonth] = useState(today.getMonth());\r\n  const [currentYear, setCurrentYear] = useState(today.getFullYear());\r\n\r\n  const monthNames = [\r\n    \"Tháng 1\",\r\n    \"Tháng 2\",\r\n    \"Tháng 3\",\r\n    \"Tháng 4\",\r\n    \"Tháng 5\",\r\n    \"Tháng 6\",\r\n    \"Tháng 7\",\r\n    \"Tháng 8\",\r\n    \"Tháng 9\",\r\n    \"Tháng 10\",\r\n    \"Tháng 11\",\r\n    \"Tháng 12\",\r\n  ];\r\n\r\n  const days = useMemo(() => {\r\n    const firstDay = new Date(currentYear, currentMonth, 1).getDay(); // 0=CN\r\n    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();\r\n    const arr = [];\r\n\r\n    for (let i = 0; i < firstDay; i++) arr.push(null);\r\n\r\n    for (let d = 1; d <= daysInMonth; d++) {\r\n      const dateObj = new Date(currentYear, currentMonth, d);\r\n      const dateStr = toDateStr(dateObj);\r\n      const isToday = dateStr === TODAY_STR;\r\n      const isPast =\r\n        dateObj <\r\n        new Date(today.getFullYear(), today.getMonth(), today.getDate());\r\n      const isSelected = selectedDate === dateStr;\r\n      arr.push({ d, dateStr, isToday, isPast, isSelected });\r\n    }\r\n\r\n    const rem = arr.length % 7;\r\n    if (rem) for (let i = 0; i < 7 - rem; i++) arr.push(null);\r\n\r\n    return arr;\r\n  }, [currentMonth, currentYear, selectedDate]);\r\n\r\n  const previousMonth = () => {\r\n    if (currentMonth === 0) {\r\n      setCurrentMonth(11);\r\n      setCurrentYear((y) => y - 1);\r\n    } else setCurrentMonth((m) => m - 1);\r\n  };\r\n  const nextMonth = () => {\r\n    if (currentMonth === 11) {\r\n      setCurrentMonth(0);\r\n      setCurrentYear((y) => y + 1);\r\n    } else setCurrentMonth((m) => m + 1);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-xl shadow-sm p-6\">\r\n      <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Chọn ngày</h3>\r\n\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <button\r\n          onClick={previousMonth}\r\n          className=\"p-2 hover:bg-gray-100 rounded-lg\"\r\n          aria-label=\"Tháng trước\"\r\n        >\r\n          <svg\r\n            className=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth=\"2\"\r\n              d=\"M15 19l-7-7 7-7\"\r\n            />\r\n          </svg>\r\n        </button>\r\n        <h4 className=\"text-lg font-semibold\">\r\n          {monthNames[currentMonth]}, {currentYear}\r\n        </h4>\r\n        <button\r\n          onClick={nextMonth}\r\n          className=\"p-2 hover:bg-gray-100 rounded-lg\"\r\n          aria-label=\"Tháng sau\"\r\n        >\r\n          <svg\r\n            className=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth=\"2\"\r\n              d=\"M9 5l7 7-7 7\"\r\n            />\r\n          </svg>\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-7 gap-1 mb-2\">\r\n        {[\"CN\", \"T2\", \"T3\", \"T4\", \"T5\", \"T6\", \"T7\"].map((w) => (\r\n          <div\r\n            key={w}\r\n            className=\"text-center text-sm font-medium text-gray-500 py-2\"\r\n          >\r\n            {w}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-7 gap-1\">\r\n        {days.map((cell, idx) => {\r\n          if (!cell) return <div key={`e-${idx}`} />;\r\n          const { d, dateStr, isToday, isPast, isSelected } = cell;\r\n\r\n          const base = \"p-3 text-center rounded-lg transition-all select-none\";\r\n          const state = isPast\r\n            ? \"text-gray-400 cursor-not-allowed\"\r\n            : isSelected\r\n            ? \"bg-gradient-to-br from-emerald-600 to-amber-500 text-white shadow cursor-pointer\"\r\n            : isToday\r\n            ? \"ring-2 ring-amber-400 text-emerald-700 cursor-pointer\"\r\n            : \"hover:bg-gray-100 cursor-pointer\";\r\n\r\n          return (\r\n            <div\r\n              key={dateStr}\r\n              className={`${base} ${state}`}\r\n              onClick={!isPast ? () => onDateSelect(dateStr) : undefined}\r\n              title={dateStr}\r\n            >\r\n              {d}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction TimeAndDuration({\r\n  service,\r\n  duration,\r\n  setDuration,\r\n  selectedDate,\r\n  selectedTime,\r\n  setSelectedTime,\r\n  totalPrice,\r\n}) {\r\n  const minHours = service?.minHours ?? 2;\r\n\r\n  const minTime = useMemo(() => {\r\n    if (!selectedDate) return \"00:00\";\r\n    if (selectedDate !== TODAY_STR) return \"00:00\";\r\n    const now = new Date();\r\n    const hh = String(now.getHours()).padStart(2, \"0\");\r\n    const mm = String(now.getMinutes()).padStart(2, \"0\");\r\n    return `${hh}:${mm}`;\r\n  }, [selectedDate]);\r\n\r\n  const adjust = (delta) => {\r\n    const v = Number((duration + delta).toFixed(1));\r\n    if (v >= minHours && v <= 8) setDuration(v);\r\n  };\r\n\r\n  const isTimeValid = useMemo(() => {\r\n    if (!selectedDate || !selectedTime) return false;\r\n    if (selectedDate !== TODAY_STR) return true;\r\n    const [hh, mm] = selectedTime.split(\":\").map(Number);\r\n    const chosen = new Date(\r\n      `${selectedDate}T${String(hh).padStart(2, \"0\")}:${String(mm).padStart(\r\n        2,\r\n        \"0\"\r\n      )}:00`\r\n    );\r\n    return chosen.getTime() >= Date.now();\r\n  }, [selectedDate, selectedTime]);\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-xl shadow-sm p-6\">\r\n      <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n        Chọn giờ & thời lượng\r\n      </h3>\r\n\r\n      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n        Giờ bắt đầu\r\n      </label>\r\n      <input\r\n        type=\"time\"\r\n        step={60}\r\n        min={minTime}\r\n        max=\"23:59\"\r\n        value={selectedTime || \"\"}\r\n        onChange={(e) => setSelectedTime(e.target.value)}\r\n        className=\"w-full rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-600\"\r\n      />\r\n      <p className=\"mt-2 text-xs text-gray-500\">\r\n        Bạn có thể chọn bất kỳ thời điểm nào trong ngày (độ phân giải 1 phút).\r\n      </p>\r\n\r\n      {!isTimeValid && selectedTime && selectedDate === TODAY_STR && (\r\n        <div className=\"mt-3 text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded-lg p-3\">\r\n          Giờ bạn chọn đã qua so với thời điểm hiện tại. Vui lòng chọn giờ lớn\r\n          hơn.\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"mt-6\">\r\n        <h4 className=\"font-medium text-gray-900 mb-3\">Thời gian làm việc</h4>\r\n        <div className=\"flex items-center gap-4\">\r\n          <button\r\n            onClick={() => adjust(-0.5)}\r\n            className=\"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200\"\r\n          >\r\n            -\r\n          </button>\r\n          <div className=\"flex-1 text-center\">\r\n            <div className=\"text-2xl font-bold bg-gradient-to-r from-emerald-600 to-amber-500 bg-clip-text text-transparent\">\r\n              {duration.toFixed(1)}\r\n            </div>\r\n            <div className=\"text-sm text-gray-500\">\r\n              giờ (tối thiểu {minHours} giờ)\r\n            </div>\r\n          </div>\r\n          <button\r\n            onClick={() => adjust(0.5)}\r\n            className=\"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center hover:bg-gray-200\"\r\n          >\r\n            +\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"mt-3 text-center\">\r\n          <div className=\"text-lg font-semibold text-gray-900\">\r\n            Tổng tiền:{\" \"}\r\n            <span className=\"text-emerald-600\">\r\n              {totalPrice.toLocaleString(\"vi-VN\")}đ\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction StepTime({\r\n  service,\r\n  selectedDate,\r\n  setSelectedDate,\r\n  selectedTime,\r\n  setSelectedTime,\r\n  duration,\r\n  setDuration,\r\n  onNext,\r\n  onBack,\r\n  totalPrice,\r\n}) {\r\n  const canNext =\r\n    selectedDate &&\r\n    selectedTime &&\r\n    (selectedDate !== TODAY_STR ||\r\n      (() => {\r\n        const [hh, mm] = selectedTime.split(\":\").map(Number);\r\n        const chosen = new Date(\r\n          `${selectedDate}T${String(hh).padStart(2, \"0\")}:${String(mm).padStart(\r\n            2,\r\n            \"0\"\r\n          )}:00`\r\n        );\r\n        return chosen.getTime() >= Date.now();\r\n      })());\r\n\r\n  return (\r\n    <>\r\n      <div className=\"text-center mb-8\">\r\n        <h1 className=\"text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 mb-3\">\r\n          Chọn thời gian\r\n        </h1>\r\n        <p className=\"text-gray-600\">\r\n          Lựa chọn ngày & giờ phù hợp với lịch trình của bạn\r\n        </p>\r\n        {service && (\r\n          <div className=\"mt-3 text-sm text-gray-600\">\r\n            Dịch vụ: <span className=\"font-semibold\">{service.name}</span> •\r\n            Giá: {service.price.toLocaleString(\"vi-VN\")}đ/giờ • Tối thiểu{\" \"}\r\n            {service.minHours}h\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"grid lg:grid-cols-2 gap-8\">\r\n        <Calendar selectedDate={selectedDate} onDateSelect={setSelectedDate} />\r\n        <TimeAndDuration\r\n          service={service}\r\n          duration={duration}\r\n          setDuration={setDuration}\r\n          selectedDate={selectedDate}\r\n          selectedTime={selectedTime}\r\n          setSelectedTime={setSelectedTime}\r\n          totalPrice={totalPrice}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"mt-8 flex justify-between\">\r\n        <button\r\n          onClick={onBack}\r\n          className=\"px-8 py-3 rounded-lg font-semibold bg-gray-200 text-gray-700 hover:bg-gray-300 transition\"\r\n        >\r\n          Quay lại\r\n        </button>\r\n        <button\r\n          onClick={onNext}\r\n          disabled={!canNext}\r\n          className=\"px-8 py-3 rounded-lg font-semibold text-white shadow disabled:cursor-not-allowed disabled:opacity-50\r\n                     bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\r\n                     focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\"\r\n        >\r\n          Tiếp tục\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n/* =========================\r\n   Step 3: Thông tin khách hàng\r\n========================= */\r\nfunction StepCustomer({\r\n  customerInfo,\r\n  setCustomerInfo,\r\n  onNext,\r\n  onBack,\r\n  pricing,\r\n}) {\r\n  const handleInputChange = (field, value) => {\r\n    setCustomerInfo({ ...customerInfo, [field]: value });\r\n  };\r\n\r\n  const validateAndNext = () => {\r\n    const { name, phone, address } = customerInfo;\r\n    if (!name.trim() || !phone.trim() || !address.trim()) {\r\n      alert(\r\n        \"Vui lòng điền đầy đủ thông tin bắt buộc (Họ tên, Số điện thoại, Địa chỉ)\"\r\n      );\r\n      return;\r\n    }\r\n    onNext();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"text-center mb-8\">\r\n        <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n          Thông tin khách hàng\r\n        </h2>\r\n        <p className=\"text-gray-600\">\r\n          Vui lòng cung cấp thông tin để chúng tôi liên lạc và cung cấp dịch vụ\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"grid lg:grid-cols-3 gap-8\">\r\n        <div className=\"lg:col-span-2 bg-white rounded-xl shadow-sm p-8\">\r\n          <div className=\"space-y-6\">\r\n            <div className=\"grid md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Họ và tên *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={customerInfo.name}\r\n                  onChange={(e) => handleInputChange(\"name\", e.target.value)}\r\n                  className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\"\r\n                  placeholder=\"Nhập họ và tên\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Số điện thoại *\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  value={customerInfo.phone}\r\n                  onChange={(e) => handleInputChange(\"phone\", e.target.value)}\r\n                  className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\"\r\n                  placeholder=\"Nhập số điện thoại\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Email\r\n              </label>\r\n              <input\r\n                type=\"email\"\r\n                value={customerInfo.email}\r\n                onChange={(e) => handleInputChange(\"email\", e.target.value)}\r\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\"\r\n                placeholder=\"Nhập địa chỉ email\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Địa chỉ *\r\n              </label>\r\n              <textarea\r\n                rows={3}\r\n                value={customerInfo.address}\r\n                onChange={(e) => handleInputChange(\"address\", e.target.value)}\r\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\"\r\n                placeholder=\"Nhập địa chỉ chi tiết (số nhà, đường, phường/xã, quận/huyện)\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Ghi chú đặc biệt\r\n              </label>\r\n              <textarea\r\n                rows={3}\r\n                value={customerInfo.notes}\r\n                onChange={(e) => handleInputChange(\"notes\", e.target.value)}\r\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-600 focus:border-emerald-600\"\r\n                placeholder=\"Yêu cầu đặc biệt, hướng dẫn đến địa chỉ, lưu ý về thú cưng...\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"bg-emerald-50 border border-emerald-200 p-4 rounded-lg\">\r\n              <h4 className=\"font-medium text-emerald-900 mb-2\">\r\n                Phương thức thanh toán\r\n              </h4>\r\n              <div className=\"space-y-2\">\r\n                <label className=\"flex items-center cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"payment\"\r\n                    value=\"cash\"\r\n                    checked={customerInfo.paymentMethod === \"cash\"}\r\n                    onChange={(e) =>\r\n                      handleInputChange(\"paymentMethod\", e.target.value)\r\n                    }\r\n                    className=\"accent-emerald-600\"\r\n                  />\r\n                  <span className=\"ml-2 text-emerald-800\">\r\n                    💰 Thanh toán tiền mặt\r\n                  </span>\r\n                </label>\r\n                <label className=\"flex items-center cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"payment\"\r\n                    value=\"online\"\r\n                    checked={customerInfo.paymentMethod === \"online\"}\r\n                    onChange={(e) =>\r\n                      handleInputChange(\"paymentMethod\", e.target.value)\r\n                    }\r\n                    className=\"accent-emerald-600\"\r\n                  />\r\n                  <span className=\"ml-2 text-emerald-800\">\r\n                    💳 Thanh toán online{\" \"}\r\n                    <span className=\"font-semibold\">(Giảm 5%)</span>\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <aside className=\"bg-white rounded-xl shadow-sm p-6 h-max\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n            Tóm tắt đơn hàng\r\n          </h3>\r\n          <div className=\"space-y-3 text-sm\">\r\n            <Row label=\"Dịch vụ\" value={pricing.serviceName} />\r\n            <Row label=\"Ngày\" value={pricing.date} />\r\n            <Row label=\"Giờ bắt đầu\" value={pricing.time} />\r\n            <Row label=\"Thời lượng\" value={`${pricing.duration} giờ`} />\r\n            <Row\r\n              label=\"Tạm tính\"\r\n              value={`${pricing.subtotal.toLocaleString(\"vi-VN\")}đ`}\r\n            />\r\n            {pricing.discount > 0 && (\r\n              <Row\r\n                label=\"Giảm giá (5% online)\"\r\n                value={`- ${pricing.discount.toLocaleString(\"vi-VN\")}đ`}\r\n                className=\"text-emerald-700\"\r\n              />\r\n            )}\r\n            <div className=\"pt-3 mt-3 border-t border-gray-200 flex items-center justify-between\">\r\n              <span className=\"font-semibold text-gray-900\">Tổng cộng</span>\r\n              <span className=\"text-lg font-bold text-emerald-600\">\r\n                {pricing.total.toLocaleString(\"vi-VN\")}đ\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </aside>\r\n      </div>\r\n\r\n      <div className=\"mt-8 flex justify-between\">\r\n        <button\r\n          onClick={onBack}\r\n          className=\"bg-gray-200 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors\"\r\n        >\r\n          Quay lại\r\n        </button>\r\n        <button\r\n          onClick={validateAndNext}\r\n          className=\"px-8 py-3 rounded-lg font-semibold text-white shadow\r\n                     bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\r\n                     focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\"\r\n        >\r\n          Tiếp tục\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction Row({ label, value, className = \"\" }) {\r\n  return (\r\n    <div className={`flex items-center justify-between ${className}`}>\r\n      <span className=\"text-gray-600\">{label}</span>\r\n      <span className=\"text-gray-900 font-medium\">{value}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* =========================\r\n   Step 4: Xác nhận\r\n========================= */\r\nfunction formatDateVN(dateString) {\r\n  if (!dateString) return \"\";\r\n  const d = new Date(dateString);\r\n  return d.toLocaleDateString(\"vi-VN\", {\r\n    weekday: \"long\",\r\n    year: \"numeric\",\r\n    month: \"long\",\r\n    day: \"numeric\",\r\n  });\r\n}\r\n\r\nfunction StepConfirm({\r\n  service,\r\n  date,\r\n  time,\r\n  duration,\r\n  customer,\r\n  pricing,\r\n  onBack,\r\n  onConfirm,\r\n}) {\r\n  if (!service || !customer) return null;\r\n  return (\r\n    <>\r\n      <div className=\"text-center mb-8\">\r\n        <h1 className=\"text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 mb-3\">\r\n          Xác nhận đặt lịch\r\n        </h1>\r\n        <p className=\"text-gray-600\">\r\n          Vui lòng kiểm tra lại thông tin trước khi xác nhận\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"bg-white rounded-xl shadow-sm p-8\">\r\n        <div className=\"space-y-8\">\r\n          <section className=\"border-b pb-6\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n              Thông tin dịch vụ\r\n            </h3>\r\n            <div className=\"grid md:grid-cols-2 gap-6\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center text-xl\">\r\n                  {service.icon}\r\n                </div>\r\n                <div>\r\n                  <div className=\"font-medium text-gray-900\">\r\n                    {service.name}\r\n                  </div>\r\n                  <div className=\"text-emerald-600\">\r\n                    {service.price.toLocaleString(\"vi-VN\")}đ/giờ\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 space-y-1\">\r\n                <div>\r\n                  Ngày:{\" \"}\r\n                  <span className=\"font-medium text-gray-900\">\r\n                    {formatDateVN(date)}\r\n                  </span>\r\n                </div>\r\n                <div>\r\n                  Giờ: <span className=\"font-medium text-gray-900\">{time}</span>\r\n                </div>\r\n                <div>\r\n                  Thời lượng:{\" \"}\r\n                  <span className=\"font-medium text-gray-900\">\r\n                    {duration} giờ\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </section>\r\n\r\n          <section className=\"border-b pb-6\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n              Thông tin khách hàng\r\n            </h3>\r\n            <div className=\"grid md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-2 text-sm\">\r\n                <div>\r\n                  Họ tên:{\" \"}\r\n                  <span className=\"font-medium text-gray-900\">\r\n                    {customer.name}\r\n                  </span>\r\n                </div>\r\n                <div>\r\n                  Điện thoại:{\" \"}\r\n                  <span className=\"font-medium text-gray-900\">\r\n                    {customer.phone}\r\n                  </span>\r\n                </div>\r\n                <div>\r\n                  Email:{\" \"}\r\n                  <span className=\"font-medium text-gray-900\">\r\n                    {customer.email || \"Không có\"}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <div>\r\n                  Địa chỉ:{\" \"}\r\n                  <span className=\"font-medium text-gray-900\">\r\n                    {customer.address}\r\n                  </span>\r\n                </div>\r\n                <div>\r\n                  Thanh toán:{\" \"}\r\n                  <span className=\"font-medium text-gray-900\">\r\n                    {customer.paymentMethod === \"cash\"\r\n                      ? \"Tiền mặt\"\r\n                      : \"Thanh toán online (giảm 5%)\"}\r\n                  </span>\r\n                </div>\r\n                {customer.notes?.trim() && (\r\n                  <div>\r\n                    Ghi chú:{\" \"}\r\n                    <span className=\"font-medium text-gray-900\">\r\n                      {customer.notes}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </section>\r\n\r\n          <section>\r\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n              Chi tiết thanh toán\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <div className=\"flex justify-between items-center mb-2\">\r\n                <span className=\"text-gray-600\">Tạm tính:</span>\r\n                <span className=\"font-medium\">\r\n                  {pricing.subtotal.toLocaleString(\"vi-VN\")}đ\r\n                </span>\r\n              </div>\r\n              {pricing.discount > 0 && (\r\n                <div className=\"flex justify-between items-center mb-2\">\r\n                  <span className=\"text-emerald-700\">\r\n                    Giảm giá (5% online):\r\n                  </span>\r\n                  <span className=\"font-medium text-emerald-700\">\r\n                    -{pricing.discount.toLocaleString(\"vi-VN\")}đ\r\n                  </span>\r\n                </div>\r\n              )}\r\n              <div className=\"border-t pt-2 mt-2\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <span className=\"text-lg font-semibold text-gray-900\">\r\n                    Tổng cộng:\r\n                  </span>\r\n                  <span className=\"text-2xl font-bold text-emerald-600\">\r\n                    {pricing.total.toLocaleString(\"vi-VN\")}đ\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </section>\r\n\r\n          <div className=\"mt-8 flex justify-between\">\r\n            <button\r\n              onClick={onBack}\r\n              className=\"bg-gray-200 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors\"\r\n            >\r\n              Quay lại\r\n            </button>\r\n            <button\r\n              onClick={onConfirm}\r\n              className=\"px-8 py-3 rounded-lg font-semibold text-white shadow\r\n                         bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\r\n                         focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\"\r\n            >\r\n              Xác nhận đặt lịch\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n/* =========================\r\n   Success (hiện sau khi xác nhận, không tính bước)\r\n========================= */\r\nfunction Success({ code, onNew, onHome }) {\r\n  return (\r\n    <div className=\"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\r\n      <div className=\"bg-white rounded-xl shadow-sm p-10 text-center\">\r\n        <div className=\"text-6xl mb-6\">✅</div>\r\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-3\">\r\n          Đặt lịch thành công!\r\n        </h1>\r\n        <p className=\"text-gray-600 mb-8\">\r\n          Cảm ơn bạn đã tin tưởng CleanMate. Chúng tôi sẽ liên hệ trong thời\r\n          gian sớm nhất để xác nhận chi tiết.\r\n        </p>\r\n\r\n        <div className=\"bg-emerald-50 border border-emerald-200 p-6 rounded-lg mb-8\">\r\n          <h3 className=\"font-semibold text-emerald-900 mb-2\">\r\n            Mã đặt lịch của bạn:\r\n          </h3>\r\n          <div className=\"text-2xl font-bold text-emerald-700\">{code}</div>\r\n        </div>\r\n\r\n        <div className=\"space-y-3\">\r\n          <button\r\n            onClick={onNew}\r\n            className=\"w-full px-8 py-3 rounded-lg font-semibold text-white shadow\r\n                       bg-gradient-to-r from-emerald-600 to-amber-500 hover:opacity-95\r\n                       focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-600\"\r\n          >\r\n            Đặt lịch mới\r\n          </button>\r\n          <Link\r\n            to=\"/\"\r\n            className=\"block w-full bg-gray-200 text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors text-center\"\r\n          >\r\n            Về trang chủ\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* =========================\r\n   MAIN: Booking (4 bước)\r\n========================= */\r\nexport default function Booking() {\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n  const [selectedKey, setSelectedKey] = useState(null);\r\n  const service = selectedKey ? SERVICES[selectedKey] : null;\r\n\r\n  const [selectedDate, setSelectedDate] = useState(TODAY_STR);\r\n  const [selectedTime, setSelectedTime] = useState(\"\");\r\n  const [duration, setDuration] = useState(service?.minHours ?? 2);\r\n\r\n  const [customerInfo, setCustomerInfo] = useState({\r\n    name: \"\",\r\n    phone: \"\",\r\n    email: \"\",\r\n    address: \"\",\r\n    notes: \"\",\r\n    paymentMethod: \"cash\",\r\n  });\r\n\r\n  const subtotal = useMemo(\r\n    () => (service ? service.price * duration : 0),\r\n    [service, duration]\r\n  );\r\n  const discount = useMemo(\r\n    () =>\r\n      customerInfo.paymentMethod === \"online\" ? Math.round(subtotal * 0.05) : 0,\r\n    [customerInfo.paymentMethod, subtotal]\r\n  );\r\n  const total = useMemo(\r\n    () => Math.max(0, subtotal - discount),\r\n    [subtotal, discount]\r\n  );\r\n\r\n  const [successCode, setSuccessCode] = useState(\"\");\r\n\r\n  const goNext = () => setCurrentStep((s) => Math.min(4, s + 1));\r\n  const goBack = () => setCurrentStep((s) => Math.max(1, s - 1));\r\n\r\n  const onServiceNext = () => {\r\n    if (!selectedKey) return;\r\n    // bảo đảm duration tối thiểu theo service\r\n    setDuration(SERVICES[selectedKey].minHours);\r\n    goNext();\r\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n  };\r\n\r\n  const onTimeNext = () => {\r\n    // validate ở StepTime đã disable nút; vẫn phòng hờ:\r\n    if (!selectedDate || !selectedTime) return;\r\n    goNext();\r\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n  };\r\n\r\n  const onCustomerNext = () => {\r\n    const { name, phone, address } = customerInfo;\r\n    if (!name.trim() || !phone.trim() || !address.trim()) return;\r\n    goNext();\r\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n  };\r\n\r\n  const onConfirm = async () => {\r\n    // debug: kiểm tra token hiện có\r\n    console.log(\"Token when booking:\", localStorage.getItem(\"cm_token\"));\r\n\r\n    try {\r\n      const res = await createBooking({\r\n        CleanerId: 1,\r\n        // gửi ISO thật sự để .NET parse an toàn\r\n        StartTime: new Date(`${selectedDate}T${selectedTime}:00`).toISOString(),\r\n        DurationHours: duration,\r\n        Price: total,\r\n        Address: customerInfo.address,\r\n        Notes: customerInfo.notes,\r\n        PaymentMethod: customerInfo.paymentMethod,\r\n      });\r\n\r\n      setSuccessCode(\"CM\" + String(res.id).padStart(6, \"0\"));\r\n      setCurrentStep(99);\r\n    } catch (err) {\r\n      console.error(\"createBooking error:\", {\r\n        status: err?.response?.status,\r\n        data: err?.response?.data,\r\n      });\r\n      alert(err?.response?.data || \"Đặt lịch thất bại\");\r\n    }\r\n  };\r\n\r\n  const resetAll = () => {\r\n    setCurrentStep(1);\r\n    setSelectedKey(null);\r\n    setSelectedDate(TODAY_STR);\r\n    setSelectedTime(\"\");\r\n    setDuration(2);\r\n    setCustomerInfo({\r\n      name: \"\",\r\n      phone: \"\",\r\n      email: \"\",\r\n      address: \"\",\r\n      notes: \"\",\r\n      paymentMethod: \"cash\",\r\n    });\r\n    setSuccessCode(\"\");\r\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n  };\r\n\r\n  const pricingSummary = {\r\n    serviceName: service?.name || \"\",\r\n    date: selectedDate,\r\n    time: selectedTime,\r\n    duration,\r\n    subtotal,\r\n    discount,\r\n    total,\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 text-gray-800\">\r\n      {currentStep >= 1 && currentStep <= 4 && (\r\n        <ProgressSteps currentStep={currentStep} />\r\n      )}\r\n\r\n      <main className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10\">\r\n        {currentStep === 1 && (\r\n          <StepService\r\n            selected={selectedKey}\r\n            setSelected={setSelectedKey}\r\n            onNext={onServiceNext}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 2 && (\r\n          <StepTime\r\n            service={service}\r\n            selectedDate={selectedDate}\r\n            setSelectedDate={setSelectedDate}\r\n            selectedTime={selectedTime}\r\n            setSelectedTime={setSelectedTime}\r\n            duration={duration}\r\n            setDuration={setDuration}\r\n            totalPrice={subtotal}\r\n            onNext={onTimeNext}\r\n            onBack={goBack}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 3 && (\r\n          <StepCustomer\r\n            customerInfo={customerInfo}\r\n            setCustomerInfo={setCustomerInfo}\r\n            pricing={pricingSummary}\r\n            onNext={onCustomerNext}\r\n            onBack={goBack}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 4 && (\r\n          <StepConfirm\r\n            service={service}\r\n            date={selectedDate}\r\n            time={selectedTime}\r\n            duration={duration}\r\n            customer={customerInfo}\r\n            pricing={pricingSummary}\r\n            onBack={goBack}\r\n            onConfirm={onConfirm}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 99 && (\r\n          <Success\r\n            code={successCode}\r\n            onNew={resetAll}\r\n            onHome={() => {\r\n              /* Link trong component */\r\n            }}\r\n          />\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}